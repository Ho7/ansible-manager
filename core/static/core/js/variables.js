// Generated by CoffeeScript 1.11.1
(function() {
  var correctedIds, setTotalNumber;

  setTotalNumber = function(e, replaced, total) {
    return e.find('input').each(function() {
      var id, name;
      name = $(this).attr('name').replace(replaced, total);
      id = 'id_' + name;
      return $(this).attr({
        'name': name,
        'id': id
      });
    });
  };

  correctedIds = function() {
    return $('#variables').find('.variable').each(function(index, elem) {
      var current_number;
      elem = $(elem);
      current_number = elem.find('input:first').attr('name').split('-')[1];
      return setTotalNumber(elem, "-" + current_number + "-", "-" + index + "-");
    });
  };

  this.addForm = function() {
    var newElement, total;
    newElement = $('#empty_form').clone(true);
    newElement.removeAttr('id');
    newElement.css("display", "");
    total = $('#id_form-TOTAL_FORMS').val();
    setTotalNumber(newElement, '__prefix__', total);
    correctedIds();
    total++;
    $('#id_form-TOTAL_FORMS').val(total);
    return $('#variables').append(newElement);
  };

  this.removeElem = function(elem) {
    var total;
    elem.remove();
    total = $('#id_form-TOTAL_FORMS').val();
    total--;
    $('#id_form-TOTAL_FORMS').val(total);
    return correctedIds();
  };

}).call(this);
